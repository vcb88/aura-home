# AURA: Адаптивный Унифицированный Разумный Агент

## 1. Концепция

**AURA** — это AI-оркестратор, трансформирующий стандартный "умный дом" в по-настоящему разумную, проактивную и адаптивную систему. Вместо жестких сценариев "ЕСЛИ-ТО", AURA использует большие языковые (LLM) и визуально-языковые (VLM) модели для понимания контекста, предвосхищения потребностей пользователя и управления домом с помощью естественного языка.

Проект нацелен на производителей IoT-устройств и энтузиастов умного дома, предлагая им возможность перейти на новый уровень взаимодействия с домашней автоматизацией.

Фундаментом для AURA служит **Home Assistant**, что обеспечивает широчайшую совместимость с тысячами существующих устройств.

---

## 2. Ключевые Возможности (Features)

- **Контекстное Управление:** Система принимает решения, основываясь на совокупности данных: время, погода, показания датчиков, привычки и предпочтения пользователя.
  - *Пример: AURA не просто включает кондиционер, а учитывает, что вы не любите сильный шум ночью, и вместо этого предлагает приоткрыть окно, проверив прогноз погоды.*

- **Проактивность и Адаптация:** AURA не просто реагирует на команды, а предвосхищает потребности.
  - *Пример: Система видит по датчику CO2, что в детской стало душно, и предлагает родителям проветрить комнату, пока ребенок на прогулке.*

- **Естественный Язык:** Взаимодействие с домом происходит через естественные фразы. Голосовой ассистент (Алиса) выступает в роли "ушей и рта", передавая запросы на обработку "мозгу" — AURA.
  - *Пример: Вместо "включи свет в гостиной на 50%", вы говорите "устрой вечер кино", и AURA сама приглушит основной свет, включит подсветку и опустит шторы.*

- **Обучаемая Память:** Все взаимодействия, решения и их результаты сохраняются, позволяя системе постоянно обучаться и со временем принимать более точные и быстрые решения.
  - *Пример: Заметив, что вы несколько раз вручную выключали свет, который она включила, AURA спросит, не стоит ли ей изменить это правило автоматизации.*

- **Широкая Совместимость:** Благодаря работе поверх Home Assistant, система совместима с устройствами, поддерживающими Zigbee, Matter, Wi-Fi и другие протоколы.

---

## 3. Предлагаемая Архитектура

Архитектура AURA — это многоуровневая микросервисная система, где каждый компонент выполняет свою специализированную задачу.

1.  **Слой Интерфейса (Interface Layer):**
    *   **Источник:** Голосовые ассистенты (Алиса), мобильные приложения, чат-боты.
    *   **Задача:** Предоставить пользователю удобный способ взаимодействия с системой на естественном языке.

2.  **Слой Сбора Контекста (Data Layer):**
    *   **Источник:** Экосистема датчиков и устройств (температура, влажность, CO2, присутствие mmWave, IP-камеры).
    *   **Задача:** Непрерывно поставлять в систему актуальные данные об окружающей среде и состоянии дома.

3.  **Слой Принятия Решений (Core Logic - AURA):**
    *   **Компоненты:** AI-Оркестратор (LLM/VLM), Модуль Планирования, База Памяти.
    *   **Задача:** "Мозг" системы. Получает запрос и контекст, обращается к памяти, формирует план действий и передает его на исполнение.

4.  **Слой Исполнения (Execution Layer):**
    *   **Компонент:** Home Assistant.
    *   **Задача:** Получить конкретную команду от AURA (например, "открой окно в гостиной") и выполнить ее через соответствующее устройство.

### Детализация Памяти:
- **Краткосрочная (Redis):** Хранит текущее состояние всех устройств для мгновенного доступа.
- **Долгосрочная (TimescaleDB):** Хранит историю событий и показаний датчиков для анализа паттернов.
- **Семантическая (Vector DB):** Хранит знания, привычки и предпочтения пользователя в виде векторов для смыслового поиска.

---

## 4. Примеры Сценариев

#### Сценарий 1: Безопасность (Проактивность)
- **Ситуация:** Датчик протечки на кухне фиксирует воду.
- **Действия AURA:**
    1.  Немедленно отправляет команду на умный клапан для перекрытия воды в квартире.
    2.  Отправляет критическое уведомление на телефоны всех членов семьи.
    3.  Голосом через все колонки сообщает: "Внимание, обнаружена протечка воды на кухне. Вода перекрыта."

#### Сценарий 2: Энергоэффективность (Аналитика)
- **Ситуация:** Пользователь спрашивает: "Почему в этом месяце большой счет за электричество?"
- **Действия AURA:**
    1.  Анализирует данные с умных розеток и счетчика за последний месяц (из TimescaleDB).
    2.  Сравнивает с предыдущим периодом и выявляет аномалию: "потребление в гостиной выросло на 30% после 23:00".
    3.  Формирует ответ: "Основной рост потребления пришелся на новый обогреватель в гостиной, который часто оставался включенным на всю ночь. Рекомендую настроить его автоматическое отключение, когда в комнате никого нет."

#### Сценарий 3: Комфорт (Адаптация)
- **Ситуация:** Пользователь несколько дней подряд вручную уменьшает яркость света, которую AURA устанавливает вечером.
- **Действия AURA:**
    1.  Фиксирует повторяющееся действие как паттерн.
    2.  Формирует вопрос: "Я заметила, что вы каждый вечер уменьшаете яркость света в гостиной. Хотите, я установлю новый уровень комфорта по умолчанию на 40% вместо 70%?"

---

## 5. Технологический стек

| Компонент                  | Технология                  | Назначение                                         |
| :------------------------- | :-------------------------- | :------------------------------------------------- |
| **Язык программирования**  | Python                      | Основной язык для всех сервисов.                   |
| **Веб-фреймворк**          | FastAPI                     | Создание высокопроизводительных API.               |
| **Краткосрочная память**   | Redis                       | In-memory база данных для текущих состояний.       |
| **Долгосрочная память**    | PostgreSQL + TimescaleDB    | База данных для временных рядов (история событий). |
| **Семантическая память**   | ChromaDB / PGVector         | Векторная база данных для знаний и предпочтений.   |
| **AI-фреймворки**          | LangChain / LlamaIndex      | Реализация логики агентов и работы с LLM.          |
| **Локальный LLM-сервер**   | Ollama / llama-cpp-python   | Запуск LLM на оборудовании пользователя.           |
| **Контейнеризация**        | Docker, Docker Compose      | Упаковка и управление всеми микросервисами.        |
| **CI/CD**                  | GitHub Actions              | Автоматизация тестирования и развертывания.        |

---

## 6. Модель развертывания: Гибридная стратегия

AURA предлагает пользователю выбор между облачным удобством и локальной приватностью.

-   **AURA Cloud (SaaS):**
    -   **Для кого:** Пользователи, ценящие простоту и максимальную мощность AI.
    -   **Принцип:** Все вычисления происходят на наших серверах. Просто в установке, не требует мощного железа дома.

-   **AURA Edge (Локально):**
    -   **Для кого:** Энтузиасты и пользователи, для которых приватность данных — главный приоритет.
    -   **Принцип:** Все компоненты, включая LLM, работают на домашнем сервере пользователя. Работает без интернета, все данные остаются дома.

---

## 7. Дорожная Карта (Roadmap)

### MVP (Готово)
- Базовый Оркестратор.
- Управление климатом и освещением.
- Многоуровневая память.
- Голосовое управление через Алису.
- Поддержка облачного и локального LLM.

### Ближайшее Будущее (Q2-Q3 2025)
- **VLM (Vision-Language Models):** Использование IP-камер для получения визуального контекста.
- **Расширение совместимости:** Интеграция с Matter и Apple HomeKit.
- **Предиктивное обслуживание:** Анализ работы техники и предсказание поломок.

### Долгосрочная Перспектива (2025-2026)
- **Мультиагентная архитектура:** Выделение отдельных AI-агентов для сложных задач.
- **Интеграция с внешними сервисами:** Заказ еды, вызов такси, планирование календаря.
- **Расширенная аналитика и insights.**
- **Открытая экосистема для партнеров.**

---

## 8. Инфраструктура Разработки и Качество Кода

Для обеспечения стабильности, надежности и удобства разработки проекта, рекомендуется внедрить следующие инструменты и практики:

### 1. Локальная Среда Разработки (`docker-compose`)
- **Задача:** Упростить запуск всего проекта локально для разработки и тестирования.
- **Решение:** Создание файла `docker-compose.yml` в корне проекта, который будет одной командой поднимать все необходимые сервисы (Home Assistant, базы данных, Ollama, сервисы AURA).

### 2. Качество и Консистентность Кода
- **Задача:** Поддерживать единый стиль кода и автоматически находить потенциальные ошибки.
- **Решение:**
    - **`Black`:** Автоматический форматер для Python-кода.
    - **`Flake8`:** Линтер для поиска ошибок и нарушений стиля.
    - **`pre-commit hooks`:** Автоматический запуск этих инструментов перед каждым коммитом.

### 3. Автоматическое Тестирование
- **Задача:** Гарантировать, что новые изменения не ломают существующую функциональность.
- **Решение:**
    - **`pytest`:** Фреймворк для написания юнит- и интеграционных тестов для бэкенд-сервисов.
    - **CI/CD Интеграция:** Добавление шага `test` в GitHub Actions для автоматического прогона тестов перед каждым деплоем.

### 4. Разделение Сред (Staging / Production)
- **Задача:** Безопасно тестировать новые функции перед их выпуском для всех пользователей.
- **Решение:** Настройка отдельного "staging" окружения (например, на `staging.aurahome.tech`), куда будут выкатываться изменения из `develop` ветки для проверки.
